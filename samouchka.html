<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>самоучка</title>
</head>
<body>
<script src = 'point.js'></script>
<script src = 'pointJSHelper.js'></script>
<script>
    var js = new PointJS("2d", 1, 1, {backgroundColor: "#b9b9b9"});
    var i = 0;
    js.system.initFullPage();
    js.mouseControl.initMouseControl();
    var game = js.game;
    var ch = game.newImageObject({
        file: "chush.jpg",
        scale: 1,
        x: 100,
        y: 100
    });
    var bump = js.audio.newAudio("WavLibraryNet_Sound6123.mp3");
    js.vector.point = point;
    var su = game.newImageObject({
        file: "shpora.jpg",
        scale: 1,
        x: 1000,
        y:100
    });
    var spawn_time = 100;
    var spawnTime = spawn_time;
    ch.setUserData({
        speed: 10

    });
    var chushi = [];
    chushi.push(ch);
    console.log(chushi.length);
    game.newLoop("1", function () {
        game.clear();
        console.log(chushi.length);
        if (i <= 100){
            i ++;
            js.brush.drawText({
                text: "Баркалов, где твой атлас?!",
                x: 100,
                y: 50,
                size: 20,
                color: "black"
            });
        }
        if (i > 100 && i <= 200){
            i ++;
            js.brush.drawText({
                text: "Я его дома забыл.",
                x: 1000,
                y: 50,
                size: 20,
                color: "black"
            });

        }
        if (i > 200 && i <= 300){
            i ++;
            js.brush.drawText({
                text: "Ах ты придурок тупой!!!",
                x: 100,
                y: 50,
                size: 20,
                color: "black"
            });}
        if(i > 300) {
            for (var j = 0; j < chushi.length; j++)
                chushi[j].moveAngle(chushi[j].speed);
            su.setPositionC(js.mouseControl.getPosition());
            ch.speed += 0.0001;
            spawn_time -= 0.01;
            if (spawn_time <= 1)
                 spawn_time = 1;
            if (spawnTime <= 0) {
                spawnTime = spawn_time;
                ch.setPositionC(point(100, js.math.random(0, 800)));
                chushi.push(ch)
            }

            spawnTime --
        }

        su.draw();
        console.log(chushi.length);
        for (var l = 0; l < chushi.length; l++){
            chushi[l].draw();
            if (chushi[l].isDynamicIntersect(su.getDynamicBox())) {
                bump.replay();
                game.setLoop("2")
            }
        }
    });
    game.newLoop("2", function () {

        js.brush.drawText({
            text: "хряяяяяяяяяяяяяяяяяяяяяяяяясь",
            x: ch.getPosition().x,
            y: ch.getPosition().y,
            color: "black",
            size: 20
        });
        js.GUI.newButton({
            text: "играть ещё",
            x: game.getWH().w / 2,
            y: game.getWH().h / 2,
            events: {
                mousePress: function () {
                    location.reload()
                }
            }

        });
    });
    game.start();
    game.setLoop("1");
</script>
</body>
</html>