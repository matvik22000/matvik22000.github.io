<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src="reconnecting-websocket.min.js"></script>
    <link rel="stylesheet" href="http://www.w3schools.com/lib/w3.css">
    <link rel="shortcut icon" href="faviocn.png" type="image/png">
    <title>knock-knock</title>
    <style>

    </style>
</head>
<body>
<center>
    <div class="w3-container w3-card-4 w3-xxxlarge" style="width: 20%">
        <h2 align="center">Вы</h2>
        <img src="аноним.jpg" class="w3-image w3-opacity-min" style="width:100%">
        <div class="w3-container w3-center">
            <input class="w3-input" placeholder="ваше имя" id="name" style="margin: 5px;">
        </div>
    </div>
    <div class="w3-bar">
        <button class="w3-button w3-black w3-margin w3-padding-large w3-round-large w3-hover-opacity w3-xxxlarge" onclick="clicked()" style="font-size: 30px">Начать</button>

    </div>
    <div class="w3-bar">
        <img id="1"  class="w3-button w3-center" onclick="icon('1', '2', '3', 1)"  src="anonymous1.png">
        <img id="2" class="w3-button w3-center" onclick="icon('2', '1', '3', 2)" src="anonymous2.png">
        <img id="3" class="w3-button w3-center" onclick="icon('3', '2', '1', 3)" src="anonimus3.png">
    </div>

</center>
<script>
    localStorage.setItem("address", "");
    function registration() {
        var reg = new ReconnectingWebSocket("wss://" + "warm-bayou-37022.herokuapp.com" + "/reg");
        reg.onopen = function () {
            reg.send(localStorage.getItem("uuid"));
            console.log(localStorage.getItem("uuid"));
        };
        reg.onmessage = function (data) {
            var msg = data.data;
            console.log(msg);
            localStorage.setItem("address", msg);
            location.href = "along.html";
            re.close()
        }
    }
    if (typeof localStorage.getItem("uuid") == "object") {
        var now = new Date();
        localStorage.setItem("uuid", (now.getMilliseconds() + now.getHours() + now.getMinutes()) * Math.random(-1, 100));
    }
function clicked() {
    localStorage.setItem("name", document.getElementById("name").value);
    console.log(document.getElementById("name"));
    if(document.getElementById("name").value != ""){
        location.href = "chat.html"
    }
    else{
        alert("ведите имя!")
    }
}
function icon(id,id2, id3, num) {
    var obj = document.getElementById(id);
    obj.className = "w3-opacaity w3-center";
    var other1 = document.getElementById(id2);
    var other2 = document.getElementById(id3);
    other1.className = "w3-button w3-center";
    other2.className = "w3-button w3-center";
    localStorage.setItem("icon", num);
}
window.onload = function () {
    var name = localStorage.getItem("name");
    console.log(name);
    if(name != ""){
        document.getElementById("name").value = name;
    }
    console.log(localStorage.getItem("icon"));
    console.log(localStorage.getItem("icon").typeof);
    if(parseInt(localStorage.getItem("icon")) == 1){
        var obj = document.getElementById("1");
        obj.className = "w3-opacaity w3-center"
    }
    if(parseInt(localStorage.getItem("icon")) == 2){
        var obj = document.getElementById("2");
        obj.className = "w3-opacaity w3-center"
    }
    if(parseInt(localStorage.getItem("icon")) == 3){
        var obj = document.getElementById("3");
        obj.className = "w3-opacaity w3-center"
    }
}


</script>
</body>
</html>